<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="描述啊">
  <meta name="keywords" content="undefined">
  
    <link rel="icon" href="">
  
    
  <title>系统命令 | LeoChan&#39;s 个人博客</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.css" />
</head>

<body>
  <header>
  <div class="header-container">
    <a class='logo' href="/">
      <span>LeoChan's 个人博客</span>
    </a>
    <ul class="right-header">
      
        <li class="nav-item">
          
            <a href="/" class="item-link">首页</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/about" class="item-link">关于</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/archives" class="item-link">归档</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/tags" class="item-link">标签</a>
          
        </li>
      
    </ul>
  </div>
</header>

  <main id='post'>
  <div class="content">
    <article>
        <section class="content markdown-body">
          <h1>系统命令</h1>
          <div class='post-meta'>
            <i class="fa fa-calendar" aria-hidden="true"></i> <time>2017年07月19日</time>
            
              | <i class="fa fa-folder-open-o" aria-hidden="true"></i> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/服务器相关/">服务器相关</a>/ <a class="article-category-link" href="/categories/服务器相关/redis/">redis</a>
  </div>



            
            
          </div>
          <h1 id="MONITOR"><a href="#MONITOR" class="headerlink" title="MONITOR"></a>MONITOR</h1><p>MONITOR 是一个调试命令，返回服务器处理的每一个命令，它能帮助我们了解在数据库上发生了什么操作，可以通过redis-cli和telnet命令使用.</p>
<p>停止：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ctrl+c</div></pre></td></tr></table></figure></p>
<p>==注意：MONITOR会引起性能消耗==</p>
<h1 id="QUIT"><a href="#QUIT" class="headerlink" title="QUIT"></a>QUIT</h1><p>客户端请求与服务器关闭连接。连接将会尽可能快的将未完成的客户端请求完成处理。    </p>
<h1 id="SELECT-index"><a href="#SELECT-index" class="headerlink" title="SELECT index"></a>SELECT index</h1><p>选择一个数据库，下标值从0开始，一个新连接默认连接的数据库是DB0。</p>
<h1 id="ECHO-message"><a href="#ECHO-message" class="headerlink" title="ECHO message"></a>ECHO message</h1><p>输出信息</p>
<h1 id="PING"><a href="#PING" class="headerlink" title="PING"></a>PING</h1><p>如果后面没有参数时返回PONG，否则会返回后面带的参数。<br>这个命令经常用来测试一个连接是否还是可用的，或者用来测试一个连接的延时。<br>如果客户端处于频道订阅模式下，它将是一个multi-bulk返回，第一次时返回”pong”，之后返回空（empty bulk），除非命令后面更随了参数。</p>
<h1 id="DBSIZE"><a href="#DBSIZE" class="headerlink" title="DBSIZE"></a>DBSIZE</h1><p>返回当前数据里面keys的数量。</p>
<h1 id="FLUSHALL"><a href="#FLUSHALL" class="headerlink" title="FLUSHALL"></a>FLUSHALL</h1><p>删除所有数据库里面的所有数据，注意不是当前数据库，而是所有数据库。<br>这个命令永远不会出现失败。<br>这个操作的时间复杂度是O(N),N是数据库的数量。</p>
<h1 id="FLUSHDB"><a href="#FLUSHDB" class="headerlink" title="FLUSHDB"></a>FLUSHDB</h1><p>删除当前数据库里面的所有数据。<br>这个命令永远不会出现失败。<br>这个操作的时间复杂度是O(N),N是当前数据库的keys数量。</p>
<h1 id="SAVE"><a href="#SAVE" class="headerlink" title="SAVE"></a>SAVE</h1><p>SAVE 命令执行一个同步操作，以RDB文件的方式保存所有数据的快照 很少在生产环境直接使用SAVE 命令，因为它会阻塞所有的客户端的请求，可以使用BGSAVE 命令代替. 如果在BGSAVE命令的保存数据的子进程发生错误的时,用 SAVE命令保存最新的数据是最后的手段,详细的说明请参考持久化文档</p>
<h3 id="返回"><a href="#返回" class="headerlink" title="返回"></a>返回</h3><p>simple-string-reply: 命令成功返回OK.</p>
<h1 id="BGSAVE"><a href="#BGSAVE" class="headerlink" title="BGSAVE"></a>BGSAVE</h1><p>后台保存DB。会立即返回 OK 状态码。 Redis forks, 父进程继续提供服务以供客户端调用，子进程将DB数据保存到磁盘然后退出。如果操作成功，可以通过客户端命令LASTSAVE来检查操作结果。</p>
<h1 id="INFO-section"><a href="#INFO-section" class="headerlink" title="INFO [section]"></a>INFO [section]</h1><p>INFO命令以一种易于理解和阅读的格式，返回关于Redis服务器的各种信息和统计数值。<br>通过给定可选的参数 section ，可以让命令只返回某一部分的信息:</p>
<ul>
<li>server: Redis服务器的一般信息</li>
<li>clients: 客户端的连接部分</li>
<li>memory: 内存消耗相关信息</li>
<li>persistence: RDB和AOF相关信息</li>
<li>stats: 一般统计</li>
<li>replication: 主/从复制信息</li>
<li>cpu: 统计CPU的消耗</li>
<li>commandstats: Redis命令统计</li>
<li>cluster: Redis集群信息</li>
<li>keyspace: 数据库的相关统计<br>它也可以采取以下值:</li>
<li>all: 返回所有信息</li>
<li>default: 值返回默认设置的信息<br>如果没有使用任何参数时，默认为default。</li>
</ul>
<h1 id="CLIENT-LIST"><a href="#CLIENT-LIST" class="headerlink" title="CLIENT LIST"></a>CLIENT LIST</h1><p>Redis CLIENT LIST命令用于返回所有连接到服务器的客户端信息和统计数据。</p>
<h4 id="返回-1"><a href="#返回-1" class="headerlink" title="返回"></a>返回</h4><p>bulk-string-reply: 一个独特的字符串，格式如下：</p>
<ul>
<li>每个已连接客户端对应一行（以 LF 分割）</li>
<li>每行字符串由一系列 属性=值（property=value） 形式的域组成，每个域之间以空格分开。  </li>
</ul>
<p>下面是各字段的含义：</p>
<ul>
<li>id: 唯一的64位的客户端ID(Redis 2.8.12加入)。</li>
<li>addr: 客户端的地址和端口</li>
<li>fd: 套接字所使用的文件描述符</li>
<li>age: 以秒计算的已连接时长</li>
<li>idle: 以秒计算的空闲时长</li>
<li>flags: 客户端 flag</li>
<li>db: 该客户端正在使用的数据库 ID</li>
<li>sub: 已订阅频道的数量</li>
<li>psub: 已订阅模式的数量</li>
<li>multi: 在事务中被执行的命令数量</li>
<li>qbuf: 查询缓冲区的长度（字节为单位， 0 表示没有分配查询缓冲区）</li>
<li>qbuf-free: 查询缓冲区剩余空间的长度（字节为单位， 0 表示没有剩余空间）</li>
<li>obl: 输出缓冲区的长度（字节为单位， 0 表示没有分配输出缓冲区）</li>
<li>oll: 输出列表包含的对象数量（当输出缓冲区没有剩余空间时，命令回复会以字符串对象的形式被入队到这个队列里）</li>
<li>omem: 输出缓冲区和输出列表占用的内存总量</li>
<li>events: 文件描述符事件</li>
<li>cmd: 最近一次执行的命令</li>
</ul>
<p>客户端 flag 可以由以下部分组成：</p>
<ul>
<li>O: 客户端是 MONITOR 模式下的附属节点（slave）</li>
<li>S: 客户端是一般模式下（normal）的附属节点</li>
<li>M: 客户端是主节点（master）</li>
<li>x: 客户端正在执行事务</li>
<li>b: 客户端正在等待阻塞事件</li>
<li>i: 客户端正在等待 VM I/O 操作（已废弃）</li>
<li>d: 一个受监视（watched）的键已被修改， EXEC 命令将失败</li>
<li>c: 在将回复完整地写出之后，关闭链接</li>
<li>u: 客户端未被阻塞（unblocked）</li>
<li>U: 通过Unix套接字连接的客户端</li>
<li>r: 客户端是只读模式的集群节点</li>
<li>A: 尽可能快地关闭连接</li>
<li>N: 未设置任何 flag</li>
</ul>
<p>文件描述符事件可以是：</p>
<ul>
<li>r: 客户端套接字（在事件 loop 中）是可读的（readable）</li>
<li>w: 客户端套接字（在事件 loop 中）是可写的（writeable）</li>
</ul>

        </section>
    </article>
    
        
  </div>
  <aside>
    
    <div class="toc-container">
        <h1>目录</h1>
        <div class="content">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MONITOR"><span class="toc-number">1.</span> <span class="toc-text">MONITOR</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QUIT"><span class="toc-number">2.</span> <span class="toc-text">QUIT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SELECT-index"><span class="toc-number">3.</span> <span class="toc-text">SELECT index</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ECHO-message"><span class="toc-number">4.</span> <span class="toc-text">ECHO message</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PING"><span class="toc-number">5.</span> <span class="toc-text">PING</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DBSIZE"><span class="toc-number">6.</span> <span class="toc-text">DBSIZE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLUSHALL"><span class="toc-number">7.</span> <span class="toc-text">FLUSHALL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLUSHDB"><span class="toc-number">8.</span> <span class="toc-text">FLUSHDB</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SAVE"><span class="toc-number">9.</span> <span class="toc-text">SAVE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#返回"><span class="toc-number">9.0.1.</span> <span class="toc-text">返回</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BGSAVE"><span class="toc-number">10.</span> <span class="toc-text">BGSAVE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#INFO-section"><span class="toc-number">11.</span> <span class="toc-text">INFO [section]</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CLIENT-LIST"><span class="toc-number">12.</span> <span class="toc-text">CLIENT LIST</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#返回-1"><span class="toc-number">12.0.0.1.</span> <span class="toc-text">返回</span></a></li></ol></li></ol></li></ol></li></ol>
        </div>
    </div>
    
  </aside>
</main>



  <footer>
  <div class="copyright">
    <div>
      &copy; 2018 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a>&nbsp
    </div>
    <div>
      Theme by <a href="https://github.com/lewis-geek/hexo-theme-Aath" target="_blank">Aath</a>
    </div>
  </div>
</footer>


<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="/lib/in-view.min.js"></script>
<script src="/lib/lodash.min.js"></script>
<script>
  var isDown = true
  var oldY = 0
  inView.offset(50)

  document.body.addEventListener('touchstart', function(){});
  
  window.addEventListener('scroll', _.throttle(e => {
    var currentY = window.scrollY
    if((oldY - currentY) < 0) {
      isDown = true
    } else {
      isDown = false
    }
    oldY = currentY
  }, 250))

  $("article img").each(function() {
      var strA = "<a data-fancybox='gallery' href='" + this.src + "'></a>";
      $(this).wrapAll(strA);
  });

  $('.toc-link').each(function() {
      var href = $(this).attr("href");
      
      inView(href).on('exit', () => {
        if (isDown) {
          handleActive(href)
        }
      })

      inView(href).on('enter', () => {
        if (!isDown) {
          handleActive(href)
        }
      })

      this.onclick = function(e) {
        var pos = $(href).offset().top - 10;
        $("html,body").animate({scrollTop: pos}, 300);
        setTimeout(() => {
          handleActive(href)
        }, 350)
        return false
      }
  })

  function handleActive(href) {
    document.querySelectorAll('.toc-link').forEach(elm => {
      elm.classList.remove('active')
    })
    document.querySelector(".toc [href='"+ href +"']").classList.add('active')
  }
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.js"></script>


</body>
</html>
